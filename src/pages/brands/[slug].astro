---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { brands, type Brand } from "../../data/brands";
import type { GetStaticPaths } from "astro";
import { Image } from "astro:assets";

export const getStaticPaths: GetStaticPaths = async () => {
    return brands.map((brand) => ({
        params: { slug: brand.slug },
        props: { brand },
    }));
};

const { brand } = Astro.props as { brand: Brand };
---

<BaseLayout title={brand.name} description={brand.shortDescription}>
    <!-- Hero -->
    <section
        class="relative h-[50vh] min-h-[400px] flex items-center justify-center overflow-hidden"
    >
        {
            brand.image && (
                <div class="absolute inset-0 z-0">
                    <div
                        class="w-full h-full bg-stone-800 animate-pulse transition-colors duration-700"
                        id="brand-hero-loader"
                    >
                        <Image
                            src={brand.image}
                            alt={brand.name}
                            widths={[640, 768, 1024, 1280, 1536]}
                            sizes="100vw"
                            class="w-full h-full object-cover opacity-0 transition-opacity duration-1000"
                            onload="this.classList.remove('opacity-0'); this.classList.add('animate-kenburns'); document.getElementById('brand-hero-loader').classList.remove('bg-stone-800', 'animate-pulse');"
                        />
                    </div>
                    <div class="absolute inset-0 bg-gradient-to-b from-stone-900/60 via-stone-900/40 to-white" />
                </div>
            )
        }

        <div
            class="relative z-10 max-w-4xl mx-auto px-6 lg:px-8 text-center mt-12"
        >
            <div class="flex flex-wrap items-center justify-center gap-2 mb-6">
                {
                    brand.categories.map((cat: string) => (
                        <span class="text-xs px-3 py-1 bg-white/10 backdrop-blur-md text-white border border-white/20 rounded-full uppercase tracking-wider">
                            {cat}
                        </span>
                    ))
                }
            </div>
            <h1
                class="font-heading text-6xl md:text-8xl font-bold text-white tracking-tight mb-4 drop-shadow-2xl"
            >
                {brand.name}
            </h1>
        </div>
    </section>

    <!-- Content -->
    <section
        class="py-24 bg-white relative z-10 -mt-12 rounded-t-[3rem] shadow-[0_-20px_40px_-15px_rgba(0,0,0,0.1)]"
    >
        <div class="max-w-3xl mx-auto px-6 lg:px-8">
            <div
                class="prose prose-lg prose-p:text-text-secondary prose-headings:font-heading prose-headings:font-light mx-auto leading-relaxed"
            >
                <p
                    class="text-2xl md:text-3xl font-heading text-dark text-center mb-12 leading-snug"
                >
                    {brand.shortDescription}
                </p>
                <div class="w-24 h-1 bg-accent mx-auto mb-12"></div>
                <p class="whitespace-pre-line text-lg md:text-xl font-light">
                    {brand.description}
                </p>
            </div>

            <div
                class="mt-20 p-10 bg-bg-warm rounded-sm text-center border border-border/50 shadow-inner"
            >
                <h3 class="font-heading text-3xl text-dark mb-4">
                    Entdecke <span class="text-accent">{brand.name}</span> im N13
                </h3>
                <p class="text-text-secondary mb-10 font-light text-lg">
                    Komm vorbei, fühl die Stoffe und probier deine Favoriten an.<br
                    />
                    Wir beraten dich gerne persönlich.
                </p>
                <div
                    class="flex flex-col sm:flex-row items-center justify-center gap-6"
                >
                    <a
                        href="/#contact"
                        class="px-10 py-5 bg-white text-dark text-xs font-bold tracking-[0.2em] uppercase hover:bg-accent hover:text-white transition-all duration-500 shadow-lg"
                    >
                        Zum Store
                    </a>
                    <a
                        href="/#brands"
                        class="px-10 py-5 border border-dark text-dark text-xs font-bold tracking-[0.2em] uppercase hover:bg-dark hover:text-white transition-all duration-500"
                    >
                        Zurück zur Übersicht
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Other Brands -->
    <section
        class="py-24 bg-surface border-t border-border relative z-20 rounded-b-[3rem] shadow-[0_20px_40px_-15px_rgba(0,0,0,0.1)]"
    >
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="text-center mb-12">
                <span
                    class="text-accent text-xs tracking-[0.2em] uppercase font-bold"
                    >Entdecke mehr</span
                >
                <h2 class="font-heading text-3xl font-medium text-dark mt-2">
                    Weitere Labels
                </h2>
            </div>
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                {
                    brands
                        .filter((b) => b.slug !== brand.slug)
                        .slice(0, 4)
                        .map((b) => (
                            <a
                                href={`/brands/${b.slug}`}
                                class="group relative overflow-hidden aspect-square bg-white flex items-center justify-center border border-border hover:border-accent transition-all duration-300"
                            >
                                {b.image ? (
                                    <>
                                        <div class="absolute inset-0 w-full h-full bg-gray-200 animate-pulse">
                                            <Image
                                                src={b.image}
                                                alt={b.name}
                                                widths={[300, 600]}
                                                sizes="(max-width: 1024px) 50vw, 25vw"
                                                class="w-full h-full object-cover opacity-0 transition-all duration-700 grayscale group-hover:grayscale-0 group-hover:scale-105 group-hover:opacity-100"
                                                onload="this.classList.remove('opacity-0'); this.classList.add('opacity-80'); this.parentElement.classList.remove('bg-gray-200', 'animate-pulse');"
                                            />
                                        </div>
                                        <div class="absolute inset-0 bg-dark/20 group-hover:bg-transparent transition-colors duration-300" />
                                    </>
                                ) : null}
                                <span class="relative z-10 font-heading text-xl text-white bg-dark/80 px-4 py-2 drop-shadow-md">
                                    {b.name}
                                </span>
                            </a>
                        ))
                }
            </div>
        </div>
    </section>
</BaseLayout>
